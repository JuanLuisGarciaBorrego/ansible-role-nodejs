---

- name: Install prerequisites
  apt: name={{ item }} update_cache=yes cache_valid_time=3600
  with_items:
    - apt-transport-https
  become: yes

- name: Add apt-key
  apt_key: url=https://deb.nodesource.com/gpgkey/nodesource.gpg.key state=present
  become: yes

- name: Add repository
  apt_repository: repo="{{ item }} https://deb.nodesource.com/node_4.x {{ ansible_distribution_release | lower }} main" state=present
  with_items
    - deb
    - deb-src
  become: yes

- name: Install nodejs
  apt: name=nodejs state=present
  become: yes